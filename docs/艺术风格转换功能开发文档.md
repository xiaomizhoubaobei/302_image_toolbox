# 艺术风格转换功能开发文档

## 1. 功能概述

### 1.1 功能名称
艺术风格转换 (Artistic Style Transfer)

### 1.2 功能描述
艺术风格转换功能允许用户将普通照片转换为各种艺术风格的作品，包括油画、水彩、素描、卡通等。通过AI技术实现高质量的风格迁移，让用户轻松创作艺术作品。

### 1.3 目标用户
- 艺术爱好者和创作者
- 摄影师
- 社交媒体内容制作者
- 设计师

## 2. 功能需求

### 2.1 核心功能
1. **多种艺术风格**：提供至少10种不同的艺术风格选择
2. **自定义风格强度**：允许用户调节风格化程度
3. **实时预览**：提供转换效果的实时预览
4. **批量处理**：支持多张图片同时处理
5. **高质量输出**：保持图像细节和清晰度

### 2.2 用户界面需求
1. 风格选择面板
2. 风格强度调节滑块
3. 实时预览窗口
4. 处理进度显示
5. 批量处理选项

## 3. 技术实现方案

### 3.1 技术架构
```
前端组件层:
- StyleTransfer.tsx (主组件)
- StyleSelector.tsx (风格选择器)
- StylePreview.tsx (预览组件)
- StyleControls.tsx (控制面板)

状态管理层:
- Zustand store (扩展现有状态)
- styleTransferSlice.ts (风格转换状态)

API层:
- lib/api.ts (新增风格转换API调用)
- utils/StyleTransfer.ts (风格处理工具)

类型定义层:
- types/index.ts (新增类型定义)
```

### 3.2 API接口设计
```typescript
// 艺术风格转换API接口
interface StyleTransferAction {
  imageSrc: string;
  styleType: string; // 风格类型
  strength: number; // 风格强度 0-100
  preserveDetails: boolean; // 是否保留细节
  outputSize?: { width: number; height: number }; // 输出尺寸
}

interface StyleTransferResult {
  imageSrc: string;
  processingTime: number; // 处理时间(ms)
  styleName: string; // 应用的风格名称
}

// 风格类型定义
type ArtisticStyle = 
  | 'oil_painting'      // 油画
  | 'watercolor'        // 水彩
  | 'pencil_sketch'     // 铅笔素描
  | 'ink_wash'          // 水墨画
  | 'anime'             // 动漫风格
  | 'pop_art'           // 波普艺术
  | 'impressionism'     // 印象派
  | 'expressionism'     // 表现主义
  | 'cubism'            // 立体主义
  | 'surrealism'        // 超现实主义
  | 'abstract'          // 抽象艺术
  | 'pixel_art'         // 像素艺术
  | 'comic_book'        // 漫画风格
  | 'vintage_photo'     // 复古照片
  | 'neon_style';       // 霓虹风格

// 主要API函数
export async function transferStyle(action: StyleTransferAction): Promise<StyleTransferResult> {
  // 实现风格转换逻辑
}
```

### 3.3 组件设计

#### 3.3.1 主组件 StyleTransfer.tsx
```tsx
import React from 'react';
import { StyleSelector } from './StyleSelector';
import { StylePreview } from './StylePreview';
import { StyleControls } from './StyleControls';
import { useStyleTransferStore } from '@/stores/styleTransferSlice';

export function StyleTransfer() {
  const { 
    originalImage, 
    styledImage, 
    styleParams,
    setStyleParams,
    transferStyle,
    isProcessing
  } = useStyleTransferStore();

  return (
    <div className="style-transfer-container">
      <div className="style-transfer-header">
        <h2>艺术风格转换</h2>
        <p>将您的照片转换为各种艺术风格</p>
      </div>
      
      <div className="style-transfer-content">
        <StyleSelector 
          selectedStyle={styleParams.styleType}
          onSelectStyle={(style) => setStyleParams({ ...styleParams, styleType: style })}
        />
        
        <StylePreview 
          original={originalImage}
          styled={styledImage}
          isProcessing={isProcessing}
        />
        
        <StyleControls 
          params={styleParams}
          onChange={setStyleParams}
          onTransfer={transferStyle}
          isProcessing={isProcessing}
        />
      </div>
    </div>
  );
}
```

#### 3.3.2 风格选择器 StyleSelector.tsx
```tsx
import React from 'react';
import { ArtisticStyle } from '@/types';

interface StyleOption {
  id: ArtisticStyle;
  name: string;
  description: string;
  previewImage: string;
}

const STYLE_OPTIONS: StyleOption[] = [
  {
    id: 'oil_painting',
    name: '油画',
    description: '经典油画艺术风格',
    previewImage: '/images/styles/oil_painting.jpg'
  },
  {
    id: 'watercolor',
    name: '水彩',
    description: '清新淡雅的水彩风格',
    previewImage: '/images/styles/watercolor.jpg'
  },
  {
    id: 'pencil_sketch',
    name: '铅笔素描',
    description: '经典的铅笔素描效果',
    previewImage: '/images/styles/pencil_sketch.jpg'
  },
  {
    id: 'anime',
    name: '动漫',
    description: '日本动漫风格',
    previewImage: '/images/styles/anime.jpg'
  },
  {
    id: 'pop_art',
    name: '波普艺术',
    description: '色彩鲜艳的波普艺术',
    previewImage: '/images/styles/pop_art.jpg'
  }
  // 更多风格选项...
];

interface StyleSelectorProps {
  selectedStyle: ArtisticStyle;
  onSelectStyle: (style: ArtisticStyle) => void;
}

export function StyleSelector({ selectedStyle, onSelectStyle }: StyleSelectorProps) {
  return (
    <div className="style-selector">
      <h3>选择艺术风格</h3>
      <div className="style-grid">
        {STYLE_OPTIONS.map((style) => (
          <div 
            key={style.id}
            className={`style-option ${selectedStyle === style.id ? 'selected' : ''}`}
            onClick={() => onSelectStyle(style.id)}
          >
            <div className="style-preview">
              <img src={style.previewImage} alt={style.name} />
            </div>
            <div className="style-info">
              <h4>{style.name}</h4>
              <p>{style.description}</p>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}
```

## 4. 状态管理设计

### 4.1 Zustand Store 扩展
```typescript
// stores/styleTransferSlice.ts
import { create } from 'zustand';
import { devtools } from 'zustand/middleware';
import { ArtisticStyle } from '@/types';

interface StyleParams {
  styleType: ArtisticStyle;
  strength: number;
  preserveDetails: boolean;
  outputSize?: { width: number; height: number };
}

interface StyleTransferState {
  originalImage: string | null;
  styledImage: string | null;
  styleParams: StyleParams;
  isProcessing: boolean;
  setOriginalImage: (image: string) => void;
  setStyleParams: (params: StyleParams) => void;
  transferStyle: () => Promise<void>;
}

export const useStyleTransferStore = create<StyleTransferState>()(
  devtools((set, get) => ({
    originalImage: null,
    styledImage: null,
    styleParams: {
      styleType: 'oil_painting',
      strength: 70,
      preserveDetails: true,
    },
    isProcessing: false,
    
    setOriginalImage: (image) => set({ originalImage: image }),
    
    setStyleParams: (params) => set({ styleParams: params }),
    
    transferStyle: async () => {
      const { originalImage, styleParams } = get();
      if (!originalImage) return;
      
      set({ isProcessing: true });
      
      try {
        const result = await transferStyle({
          imageSrc: originalImage,
          ...styleParams
        });
        
        set({ 
          styledImage: result.imageSrc,
          isProcessing: false 
        });
      } catch (error) {
        set({ isProcessing: false });
        throw error;
      }
    }
  }))
);
```

## 5. UI/UX 设计

### 5.1 界面布局
```
+-----------------------------------------------------+
| 艺术风格转换工具                                   |
+----------------------+-----------------------------+
| 风格选择面板         | 预览区域                    |
|                      |                             |
| [油画]  [水彩]       | [原始图片]  [风格化图片]    |
| [素描]  [动漫]       |                             |
| [波普]  [印象派]     |                             |
| [更多风格...]        |                             |
+----------------------+-----------------------------+
| 控制面板                                           |
|                                                    |
| [风格强度: 70% ----o]                              |
| [√] 保留细节                                       |
|                                                    |
| [开始转换] [批量处理]                              |
+-----------------------------------------------------+
```

### 5.2 交互流程
1. 用户上传需要转换风格的图片
2. 用户从风格库中选择喜欢的艺术风格
3. 调整风格强度和其他参数
4. 实时预览风格化效果
5. 点击"开始转换"按钮
6. 显示处理进度
7. 展示风格化后的图片
8. 提供下载和继续编辑选项

## 6. 开发计划

### 6.1 第一阶段：基础框架搭建 (1周)
- [ ] 创建组件结构和文件
- [ ] 实现 Zustand 状态管理
- [ ] 设计 UI 组件
- [ ] 实现图片上传功能

### 6.2 第二阶段：核心功能开发 (2周)
- [ ] 实现油画风格转换
- [ ] 实现水彩风格转换
- [ ] 实现素描风格转换
- [ ] 实现动漫风格转换

### 6.3 第三阶段：扩展功能开发 (1周)
- [ ] 实现其他艺术风格
- [ ] 添加批量处理功能
- [ ] 优化处理性能

### 6.4 第四阶段：测试与优化 (1周)
- [ ] 功能测试
- [ ] 性能优化
- [ ] 用户体验优化
- [ ] 文档完善

## 7. 测试方案

### 7.1 单元测试
- 测试状态管理功能
- 测试风格选择逻辑
- 测试参数验证逻辑

### 7.2 集成测试
- 测试完整的风格转换流程
- 测试不同风格的效果
- 测试批量处理功能

### 7.3 用户验收测试
- 邀请艺术爱好者测试效果
- 收集用户反馈
- 优化用户体验

## 8. 部署与维护

### 8.1 部署要求
- 确保302.AI API密钥配置正确
- 验证图像上传和处理功能
- 测试不同浏览器兼容性

### 8.2 维护计划
- 定期更新AI模型
- 添加新的艺术风格
- 监控API调用情况
- 收集用户反馈并持续优化